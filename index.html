<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã ‚≠êÔ∏è</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@600&display=swap');
  body {
    margin: 0;
    background: linear-gradient(135deg, #1e1e1e, #111);
    color: #fff;
    font-family: 'Montserrat', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    overflow: hidden;
    user-select: none;
  }
  h1 {
    margin-bottom: 0.2em;
    color: #f7b500;
    text-shadow: 0 0 8px #f7b500;
  }
  #balance, #spins {
    font-size: 1.3em;
    margin: 0.3em 0;
    font-weight: 600;
    color: #ffd843;
    text-shadow: 0 0 5px #f7b500;
  }
  #wheel-container {
    position: relative;
    width: 400px;
    height: 400px;
    perspective: 1200px;
    margin: 30px 0;
  }
  #wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background: radial-gradient(circle at center, #f9d71c 0%, #cda200 80%);
    box-shadow:
      inset 0 0 20px #fff200,
      0 10px 30px rgba(255, 183, 0, 0.9);
    position: relative;
    transform-style: preserve-3d;
    transition: transform 5s cubic-bezier(0.33, 1, 0.68, 1);
    border: 6px solid #e5b600;
  }
  /* –°–µ–≥–º–µ–Ω—Ç—ã */
  .segment {
    position: absolute;
    width: 50%;
    height: 50%;
    top: 50%;
    left: 50%;
    transform-origin: 0% 0%;
    overflow: visible;
    border-right: 2px solid #a57f00;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    padding-left: 12px;
    box-sizing: border-box;
    color: #3a2700;
    font-weight: 700;
    text-shadow: 0 0 3px #fff7a5;
    font-size: 1.2em;
  }
  .segment .icon {
    margin-right: 6px;
    font-size: 1.5em;
    filter: drop-shadow(0 0 3px #ffec52);
  }
  /* –°—Ç—Ä–µ–ª–∫–∞ */
  #pointer {
    position: absolute;
    top: -35px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 4em;
    color: #ffd843;
    text-shadow: 0 0 12px #f7b500;
    user-select: none;
    pointer-events: none;
    z-index: 10;
  }
  /* –ö–Ω–æ–ø–∫–∏ */
  button {
    background: linear-gradient(45deg, #f9d71c, #cda200);
    border: none;
    border-radius: 35px;
    padding: 15px 35px;
    font-weight: 700;
    font-size: 1.2em;
    margin: 12px;
    cursor: pointer;
    box-shadow: 0 0 20px #f7b500;
    color: #3a2700;
    transition: background 0.3s ease;
    user-select: none;
  }
  button:disabled {
    background: #555;
    color: #aaa;
    cursor: not-allowed;
    box-shadow: none;
  }
  button:hover:not(:disabled) {
    background: linear-gradient(45deg, #fff859, #f9d71c);
  }
  #result {
    margin-top: 20px;
    font-size: 1.4em;
    font-weight: 700;
    color: #ffeb3b;
    text-shadow: 0 0 8px #f7b500;
    min-height: 1.7em;
    user-select: text;
    max-width: 350px;
    text-align: center;
  }
</style>
</head>
<body>

<h1>–ö–æ–ª–µ—Å–æ –§–æ—Ä—Ç—É–Ω—ã ‚≠êÔ∏è</h1>
<div id="balance">–ë–∞–ª–∞–Ω—Å –∑–≤—ë–∑–¥: <strong>0.00</strong></div>
<div id="spins">–í—Ä–∞—â–µ–Ω–∏—è: 0</div>

<div id="wheel-container">
  <div id="pointer">‚ñº</div>
  <div id="wheel"></div>
</div>

<button id="spin-btn" disabled>–í—Ä–∞—â–∞—Ç—å –∫–æ–ª–µ—Å–æ</button>
<button id="task-btn">–û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞–Ω–∏–µ (+5 –≤—Ä–∞—â–µ–Ω–∏–π)</button>

<div id="result"></div>

<script>
  // –ü—Ä–∏–∑—ã –∏ –∏—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏ —Ü–≤–µ—Ç–∞
  const segments = [
    { label: '‚≠êÔ∏è 0.5', value: 0.5, color: '#f9d71c', icon: '‚≠êÔ∏è' },
    { label: '‚≠êÔ∏è 1', value: 1, color: '#f7b500', icon: '‚≠êÔ∏è' },
    { label: '‚≠êÔ∏è 0.7', value: 0.7, color: '#f9d71c', icon: '‚≠êÔ∏è' },
    { label: 'Mystery Box 5', value: 'mystery5', color: '#ff6f61', icon: 'üéÅ' },
    { label: '‚≠êÔ∏è 2', value: 2, color: '#f7b500', icon: '‚≠êÔ∏è' },
    { label: '‚≠êÔ∏è 0.2', value: 0.2, color: '#f9d71c', icon: '‚≠êÔ∏è' },
    { label: 'Mystery Box 3', value: 'mystery3', color: '#ff6f61', icon: 'üéÅ' },
    { label: '‚≠êÔ∏è 0.07', value: 0.07, color: '#f7b500', icon: '‚≠êÔ∏è' },
    { label: '‚≠êÔ∏è 5', value: 5, color: '#f9d71c', icon: '‚≠êÔ∏è' },
    { label: 'Mystery Box 2', value: 'mystery2', color: '#ff6f61', icon: 'üéÅ' },
  ];

  const segmentCount = segments.length;
  const segmentAngle = 360 / segmentCount;

  const wheel = document.getElementById('wheel');
  const balanceEl = document.querySelector('#balance strong');
  const spinsEl = document.getElementById('spins');
  const spinBtn = document.getElementById('spin-btn');
  const taskBtn = document.getElementById('task-btn');
  const resultEl = document.getElementById('result');

  let stars = 0;
  let spins = 0;
  let isSpinning = false;
  let currentRotation = 0;

  // –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∫–æ–ª–µ—Å–∞ —Å 3D-—ç—Ñ—Ñ–µ–∫—Ç–æ–º
  segments.forEach((seg, i) => {
    const segEl = document.createElement('div');
    segEl.className = 'segment';
    segEl.style.backgroundColor = seg.color;
    segEl.style.transform = `rotate(${i * segmentAngle}deg) skewY(-${90 - segmentAngle}deg)`;

    // –°–æ–∑–¥–∞–µ–º –∏–∫–æ–Ω–∫—É + —Ç–µ–∫—Å—Ç
    const iconSpan = document.createElement('span');
    iconSpan.className = 'icon';
    iconSpan.textContent = seg.icon;

    const labelSpan = document.createElement('span');
    labelSpan.textContent = ` ${seg.label}`;

    segEl.appendChild(iconSpan);
    segEl.appendChild(labelSpan);
    wheel.appendChild(segEl);
  });

  function updateUI() {
    balanceEl.textContent = stars.toFixed(2);
    spinsEl.textContent = `–í—Ä–∞—â–µ–Ω–∏—è: ${spins}`;
    spinBtn.disabled = spins <= 0 || isSpinning;
  }

  function openTask() {
    if (isSpinning) return;
    spins += 5;
    resultEl.textContent = '';
    updateUI();
  }

  function spinWheel() {
    if (spins <= 0 || isSpinning) return;
    isSpinning = true;
    spins--;
    resultEl.textContent = '';
    updateUI();

    // –í—ã–±–æ—Ä –ø—Ä–∏–∑–æ–≤–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ —Å –≤–µ—Å–∞–º–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
    const weights = segments.map(s => {
      if (typeof s.value === 'number') {
        // –ß–µ–º –±–æ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ - —Ç–µ–º –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
        return 1 / (s.value + 0.1);
      }
      if (s.value.toString().startsWith('mystery')) {
        return 0.5; // Mystery box —Å—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
      }
      return 1;
    });

    const totalWeight = weights.reduce((a, b) => a + b, 0);
    let rnd = Math.random() * totalWeight;
    let chosenIndex = 0;
    for (let i = 0; i < weights.length; i++) {
      if (rnd < weights[i]) {
        chosenIndex = i;
        break;
      }
      rnd -= weights[i];
    }

    // –ö—Ä—É—Ç–∏–º –∫–æ–ª–µ—Å–æ
    const baseRotations = 6; // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω—ã—Ö –æ–±–æ—Ä–æ—Ç–æ–≤
    const randomOffset = Math.random() * segmentAngle;
    const finalAngle = 360 * baseRotations - (chosenIndex * segmentAngle) - (segmentAngle / 2) + randomOffset;

    currentRotation = (currentRotation + finalAngle) % 360;

    wheel.style.transition = 'transform 5s cubic-bezier(0.33, 1, 0.68, 1)';
    wheel.style.transform = `rotate(${currentRotation}deg)`;

    setTimeout(() => {
      isSpinning = false;
      const prize = segments[chosenIndex];
      let wonStars = 0;
      if (typeof prize.value === 'number') {
        wonStars = prize.value;
        stars += wonStars;
        resultEl.textContent = `üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${prize.label} –∑–≤—ë–∑–¥!`;
      } else if (prize.value.toString().startsWith('mystery')) {
        if (prize.value === 'mystery5') wonStars = 5;
        else if (prize.value === 'mystery3') wonStars = 3;
        else if (prize.value === 'mystery2') wonStars = 2;
        stars += wonStars;
        resultEl.textContent = `üéÅ –í—ã –ø–æ–ª—É—á–∏–ª–∏ Mystery Box —Å ${wonStars} –∑–≤—ë–∑–¥–∞–º–∏!`;
      }
      updateUI();
      wheel.style.transition = 'none';
      wheel.style.transform = `rotate(${currentRotation}deg)`;
    }, 5200);
  }

  spinBtn.addEventListener('click', spinWheel);
  taskBtn.addEventListener('click', openTask);

  updateUI();
</script>

</body>
</html>
